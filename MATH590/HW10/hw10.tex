\documentclass{article}

\title{Math 590 HW10}
\author{Grant Saggars}
\date{\today}

\usepackage{amsmath}
\usepackage{import}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{xcolor}
\usepackage{framed}
\usepackage{enumerate}
\usepackage{geometry}
\usepackage{cancel}
\usepackage{multicol}
\usepackage{lipsum}  
\usepackage{caption}
\usepackage{float}
\usepackage{bbold}
% \usepackage{fontspec}

% \setmainfont{BespokeSerif-Regular}
\definecolor{shadecolor}{RGB}{235,235,235}

\geometry{top=1in, bottom=1in, left=1in, right=1in}
\newenvironment{callout}[1] {\begin{shaded*} \textbf{#1}} {\end{shaded*}}

%%%%%%%%%%%%%%%%%%%%%%%%
% DOCUMENT BEGINS HERE %
%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\maketitle

\begin{enumerate}

\item Let ${f_n}$ be the sequence given by $a_0 = 0$, $a_1 = 5$, $a_{n+1} = a_n + 6a_{n-1}$ for each $n \geq 1$. Use diagonalization to find the general formula for $a_n$.

\begin{callout}{Solution:}
    \begin{enumerate}[(a)]
        \item The sequence $f_n$ is given by $f_n = 6f_{n-2} + f_{n-1}$ Define $T \in \mathcal{L}(\textbf{R}^2)$ by $T(x,y) = (y, 6x + y)$. It follows that $T^{n}(0, 5) = (f_n, f_{n-1})$ for each positive integer $n$:
            \begin{align*}
                \begin{pmatrix} 0 & 5 \end{pmatrix}
                \begin{pmatrix} 0 & 1 \\ 6 & 1 \end{pmatrix} &= 
                \begin{pmatrix} 30 & 5 \end{pmatrix} \\
                \begin{pmatrix} 0 & 5 \end{pmatrix}
                \begin{pmatrix} 0 & 1 \\ 6 & 1 \end{pmatrix}^{2} &= 
                \begin{pmatrix} 30 & 35 \end{pmatrix} \\
                \begin{pmatrix} 0 & 5 \end{pmatrix}
                \begin{pmatrix} 0 & 1 \\ 6 & 1 \end{pmatrix}^{3} &= 
                \begin{pmatrix} 210 & 65 \end{pmatrix} \\
            \end{align*}

        \item By computing the value of the matrix raised to an arbitrary power $n$, we can compute an explicit formula for the sequence. This can be done by diagonalizing:

            \begin{align*}
                -\lambda(1-\lambda) - 6 &= 0 \implies \lambda = \{ -2, 3 \} \\
                \xi_1 &= \left(\begin{array}{cc|c} 2 & 1 & 0 \\ 6 & 3 & 0 \end{array}\right) 
                \implies \xi_1 = \begin{pmatrix} 1/2 \\ 1 \end{pmatrix} \\
                \xi_2 &= \left(\begin{array}{cc|c} -3 & 1 & 0 \\ 6 & -2 & 0 \end{array}\right) 
                \implies \xi_2 = \begin{pmatrix} -1/3 \\ 1 \end{pmatrix} \\
            \end{align*}

            Therefore:

            \begin{align*}
                P &= \begin{pmatrix} 1/2 & -1/3 \\ 1 & 1 \end{pmatrix}, \quad
                P^{-1} = \begin{pmatrix} -6/5 & 2/5 \\ 6/5 & 3/5 \end{pmatrix}, \quad
                \Lambda = \begin{pmatrix} -2 & 0 \\ 0 & 3 \end{pmatrix}
            \end{align*}

        \newpage
        \item Finally, because $A = P \Lambda P^{-1}$, and $A^n = P \Lambda^n P^{-1}$, a direct formula can be computed:

            \begin{align*}
                \begin{pmatrix} 0 & 5 \end{pmatrix} 
                \begin{pmatrix} 0 & 1 \\ 6 & 1 \end{pmatrix}^{n} 
                &= \begin{pmatrix} 0 & 5 \end{pmatrix} 
                \begin{pmatrix} 1/2 & -1/3 \\ 1 & 1 \end{pmatrix}
                \begin{pmatrix} -2 & 0 \\ 0 & 3 \end{pmatrix}^{n}
                \begin{pmatrix} 6 & -2 \\ -6 & 3 \end{pmatrix} \\
                &= \begin{pmatrix} 0 & 5 \end{pmatrix} 
                \begin{pmatrix} 1/2 & -1/3 \\ 1 & 1 \end{pmatrix}
                \begin{pmatrix} (-2)^n & 0 \\ 0 & (3)^n \end{pmatrix}
                \begin{pmatrix} -6/5 & 2/5 \\ 6/5 & 3/5 \end{pmatrix}
            \end{align*}

            Which, after multiplying out the matrices, gives:

            \begin{align*}
                f_n &= -6(-2)^n + 2(3)^{1+n} \\
                f_{n-1} &= 2(-2)^n + 3^{1+n}
            \end{align*}

    \end{enumerate}
\end{callout}

\item Let $W$ be the span of
$\begin{bmatrix} 1 \ 1 \ 1 \ 1 \end{bmatrix}$,

$\begin{bmatrix} 1 \ 2 \ 3 \ 4 \end{bmatrix}$
in $\mathbb{R}^4$.
\begin{enumerate}[(a)]
\item Find $W^{\perp}$.

\begin{callout}{Solution:}
    \begin{align*}
        A &= \begin{pmatrix} 1 & 1 \\ 2 & 1 \\ 3 & 1 \\ 4 & 1 \end{pmatrix} \to A^T = \begin{pmatrix} 1 & 1 & 1 & 1 \\ 1 & 2 & 3 & 4 \end{pmatrix} \\
        W^\perp &= \ker(A^T) = A^T = 0
    \end{align*}

    The RREF form of $A$ is:

    \vspace{-0.5 cm} \begin{align*}
        \begin{pmatrix} 1 & 0 & -1 & -2 \\ 0 & 1 & 2 & 3 \end{pmatrix}
    \end{align*}

    Therefore the kernel is:

    \begin{align*}
        \begin{pmatrix} x_3 + 2x_4 \\ -2x_3 - 3x_4 \\ x_3 \\ x_4 \end{pmatrix}
        &\to \begin{pmatrix} s + 2t \\ -2s - 3t \\ s \\ t \end{pmatrix}
    \end{align*}

\end{callout}

\newpage
\item Find the point in $W$ closest to the point $(1, 1, -1, -1)$.

\begin{callout}{Solution:}

    The orthogonal projection of the given vector into $W$ will give the nearest point in $W$ to the given vector. Such a projection is:

    \begin{align*}
        v - P_Wv &= v - \frac{W \cdot v}{|v|^2} v \\
        &= v - \begin{pmatrix} \frac{-2s-2t}{4} \\ \frac{-2s-2t}{4} \\ \frac{2s+2t}{4} \\ \frac{2s+2t}{4} \end{pmatrix}
        = \begin{pmatrix} 1 \\ 1 \\ -1 \\ -1 \end{pmatrix} - \begin{pmatrix} \frac{-2s-2t}{4} \\ \frac{-2s-2t}{4} \\ \frac{2s+2t}{4} \\ \frac{2s+2t}{4} \end{pmatrix}
    \end{align*}
\end{callout}

\end{enumerate}

\item Find the best-fit parabola through the point $(1, 1)$, $(2, 2)$, $(3, 3)$, $(4, 5)$. (See section 6.5 of the text).

\begin{callout}{Solution:}
    
    The textbook describes the general method for fitting a polynomial curve to a set of points:
    \begin{align*}
        \beta &= \left( X^T X \right)^{-1} X^T Y
    \end{align*}

    Where $\beta$ is the coefficients $(a, b, c)$, $X$ the matrix of x-values arranged in row-major order. Finally, matrix $Y$ is the column vector of y-values. 

    I used Julia to optimize the curve:

\begin{verbatim}
julia> X = [1 1 1; 1 2 4; 1 3 9; 1 5 25]
4Ã—3 Matrix{Int64}:
 1  1   1
 1  2   4
 1  3   9
 1  5  25

julia> Y = [1; 2; 3; 5]
4-element Vector{Int64}:
 1
 2
 3
 5

julia> (transpose(X)*X)^-1*transpose(X)*Y
3-element Vector{Float64}:
 -2.842170943040401e-14
  1.0
  0.0
\end{verbatim}

The final curve is effectively linear, since the coefficient $a$ is quite small.

\end{callout}

\end{enumerate}

\end{document}
